# 実装計画

## タスク一覧

- [x] 1. pre-commitフックファイルの修正
- [x] 1.1 非推奨行の削除
  - `.husky/pre-commit`ファイルを開く
  - 1行目の`#!/usr/bin/env sh`を削除
  - 2行目の`. "$(dirname -- "$0")/_/husky.sh"`を削除
  - 空行を削除し、`npx lint-staged`のみを残す
  - ファイルが1行のみ（`npx lint-staged`）であることを確認
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 2. 動作確認とテスト実行
- [x] 2.1 ファイル内容の検証
  - `.husky/pre-commit`の内容を確認
  - shebang行が存在しないことを検証
  - husky.sh読み込み行が存在しないことを検証
  - `npx lint-staged`コマンドのみが含まれることを確認
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 2.2 lint-staged自動実行テスト
  - テスト用のファイルをステージングエリアに追加
  - `git commit`コマンドを実行
  - pre-commitフックが自動起動することを確認
  - lint-stagedが実行されることを確認
  - コミットが正常完了することを確認
  - _Requirements: 2.1, 2.2_

- [x] 2.3 lintエラー検出テスト
  - 意図的にlintエラーを含むファイルを作成
  - エラーファイルをステージングエリアに追加
  - `git commit`を実行
  - lint-stagedがエラーを検出することを確認
  - コミットが中断されることを確認（exit code 非ゼロ）
  - エラーメッセージが適切に表示されることを確認
  - テストファイルを削除またはリセット
  - _Requirements: 2.3_

- [x] 3. 互換性検証
- [x] 3.1 Husky v9環境での動作確認
  - 現在のHusky v9環境でコミットを実行
  - pre-commitフックがエラーなく動作することを確認
  - lint-stagedが正常実行されることを確認
  - _Requirements: 3.1_

- [x] 3.2 非推奨警告の不在確認
  - `git commit`実行時のコンソール出力を確認
  - "DEPRECATED"警告メッセージが表示されないことを検証
  - "They WILL FAIL in v10.0.0"メッセージが表示されないことを確認
  - _Requirements: 3.2_

- [x] 3.3 複数コミット連続実行テスト
  - 複数の異なるファイルを段階的にコミット
  - 各コミットでpre-commitフックが正常動作することを確認
  - フロントエンド（TypeScript）とバックエンド（PHP）の両方をテスト
  - lint-stagedが期待通りのlint処理を完了することを確認
  - _Requirements: 3.3_

- [x] 4. 最終検証と完了確認
- [x] 4.1 統合動作テスト
  - フロントエンドファイル（.ts, .tsx）をステージング
  - バックエンドファイル（.php）をステージング
  - 両方のlintツール（ESLint + Prettier、Laravel Pint）が実行されることを確認
  - コミットが正常完了することを確認
  - _Requirements: 2.1, 2.2_

- [x] 4.2 全要件達成確認
  - Requirement 1（Husky v10互換性確保）の全Acceptance Criteriaを確認
  - Requirement 2（既存機能の維持）の全Acceptance Criteriaを確認
  - Requirement 3（後方互換性検証）の全Acceptance Criteriaを確認
  - すべてのテストが成功していることを確認
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

## 要件カバレッジマップ

| Requirement | タスク | 検証方法 |
|-------------|--------|----------|
| 1.1 | 1.1, 2.1, 4.2 | shebang行不在確認 |
| 1.2 | 1.1, 2.1, 4.2 | husky.sh読み込み行不在確認 |
| 1.3 | 1.1, 2.1, 4.2 | npx lint-stagedのみ含む確認 |
| 2.1 | 2.2, 4.1, 4.2 | コミット時lint-staged自動実行確認 |
| 2.2 | 2.2, 4.1, 4.2 | フォーマット・lintチェック正常実行確認 |
| 2.3 | 2.3, 4.2 | エラー時コミット中断確認 |
| 3.1 | 3.1, 4.2 | Husky v9動作確認 |
| 3.2 | 3.2, 4.2 | 非推奨警告不在確認 |
| 3.3 | 3.3, 4.2 | 期待通りlint処理完了確認 |

## 実装順序の理由

1. **Task 1**: ファイル修正（最も重要なコア変更）
2. **Task 2**: 基本動作確認とテスト（修正後の正常動作を即座に検証）
3. **Task 3**: 互換性検証（v9/v10両対応の保証）
4. **Task 4**: 統合テストと全要件確認（完了条件の総合検証）

この順序により、問題が発生した場合に早期発見し、迅速にロールバック可能。
