{
  "feature_name": "frontend-accept-header-problem-json",
  "created_at": "2025-11-22T10:30:00Z",
  "updated_at": "2025-11-22T12:15:00Z",
  "language": "ja",
  "phase": "tasks-generated",
  "source": {
    "type": "github_issue",
    "issue_number": 116,
    "url": "https://github.com/ef-tech/laravel-next-b2c/issues/116",
    "title": "Frontend Accept headerの明示化（application/problem+json追加）",
    "labels": [],
    "milestone": null,
    "assignees": []
  },
  "extracted_info": {
    "tech_stack": {
      "backend": "Laravel API (RFC 7807準拠)",
      "frontend": "Next.js (Admin App/User App), TypeScript",
      "testing": "Jest, Playwright E2E",
      "standards": "RFC 7807 (Problem Details for HTTP APIs), HTTP Content Negotiation"
    },
    "requirements_hints": [
      "フロントエンドAPIクライアントのAcceptヘッダーに `application/problem+json` を追加",
      "RFC 7807エラーレスポンスの明示的なサポートを表明",
      "既存機能への影響ゼロで段階的な改善を実現",
      "後方互換性保証（`application/json` を常に含める）",
      "Content Negotiation適切実装"
    ],
    "project_structure": [
      "frontend/lib/api-client.ts (共通モジュール)",
      "frontend/lib/api-client-v1.ts (API V1クライアント)",
      "frontend/admin-app/src/lib/api-client.ts (Admin App)",
      "frontend/user-app/src/lib/api-client.ts (User App)",
      "frontend/admin-app/src/__tests__/lib/api-client.test.ts (テスト)"
    ],
    "services": {
      "affected_files_count": "4箇所のAPIクライアント + テストファイル",
      "no_backend_changes": "バックエンドLaravel APIは既に対応済み"
    },
    "todo_items": [
      "Task 1: `frontend/lib/api-client.ts` L180のAcceptヘッダー更新",
      "Task 2: `frontend/admin-app/src/lib/api-client.ts` L166のAcceptヘッダー更新",
      "Task 3: `frontend/user-app/src/lib/api-client.ts` L166のAcceptヘッダー更新",
      "Task 4: `frontend/lib/api-client-v1.ts` L44のAcceptヘッダー更新",
      "Task 5: テストアサーション更新（api-client.test.ts L90）",
      "Task 6: コメント更新（RFC 7807明示サポート記載）",
      "Task 7: フロントエンドユニットテスト実行（`npm test`）",
      "Task 8: E2Eテスト実行（API統合確認）",
      "Task 9: ESLintチェック実行",
      "Task 10: 開発環境での動作確認（全APIエンドポイント）",
      "Task 11: コードコメント更新（RFC 7807準拠を明示）"
    ],
    "implementation_details": {
      "change_before": "headers.set('Accept', 'application/json')",
      "change_after": "headers.set('Accept', 'application/problem+json, application/json')",
      "q_factor_omitted": "両方のMIMEタイプに q=1.0（デフォルト値）を適用",
      "priority_indication": "application/problem+json を先頭に配置"
    },
    "risk_analysis": {
      "risk_level": "低リスク",
      "backward_compatibility": "100%維持（application/json を含むため）",
      "server_ready": "LaravelはすでにRFC 7807を実装済み",
      "client_ready": "ApiError クラスが既にRFC 7807形式を解析",
      "test_coverage": "既に96.1%のカバレッジ"
    }
  },
  "approvals": {
    "requirements": {
      "generated": true,
      "approved": true
    },
    "design": {
      "generated": true,
      "approved": true
    },
    "tasks": {
      "generated": true,
      "approved": false
    }
  },
  "ready_for_implementation": false
}
