# Product Overview

## プロダクト概要
Laravel Next.js B2Cアプリケーションテンプレート - **API専用最適化Laravel 12** + Next.js 15.5のモノレポ構成で、モダンなB2Cビジネス向けの超高速開発テンプレート

### 🚀 パフォーマンス最適化済み
- **33.3%起動速度向上** (業界標準20-30%を上回る)
- **96.5%依存関係削減** (4コアパッケージ構成)
- **0.33KB/request** (画期的なメモリ効率)
- **ステートレス設計** (水平スケーリング対応)

## 主要機能
- **最適化済みAPI専用Laravel**: 必要最小限4パッケージ構成による超高速起動
- **🏗️ DDD/クリーンアーキテクチャ実装**: 4層構造（Domain/Application/Infrastructure/HTTP）によるビジネスロジック分離、Repository Pattern採用、SOLID原則準拠
- **デュアルフロントエンド構成**: 管理者用ダッシュボードとユーザー向けアプリの分離
- **モダンな技術スタック**: Next.js 15.5 + React 19 + Laravel 12 + TypeScript
- **完全なDocker環境**: Docker Compose統合による全サービス一括起動（5分セットアップ）、ヘルスチェック機能統合
- **🔐 Laravel Sanctum認証基盤**: ステートレストークン認証による水平スケーリング対応
  - **認証エンドポイント**: Login/Logout、パスワードリセット対応
  - **トークン管理**: 発行、一覧取得、取り消し、更新機能
  - **セキュリティ強化**: トークン有効期限設定、自動期限切れトークン削除（日次スケジュール実行）
  - **統合認証ガード**: Sanctum middleware統合、API保護機能
- **PostgreSQL接続最適化**: タイムアウト設定・環境別設定・信頼性向上（接続5秒、ステートメント30秒）
- **モダンテストフレームワーク**: Pest 4による包括的テストスイート（96.1%カバレッジ達成）、Architecture Testing統合
- **テストDB環境切り替え**: SQLite（高速開発）/PostgreSQL（本番同等）の柔軟な切り替え、並列テスト実行（4 Shard）、Makefileタスク統合
- **フロントエンドテスト環境**: Jest 29 + Testing Library 16完全実装（カバレッジ94.73%達成）
- **E2Eテスト環境**: Playwright 1.47.2 + Docker実行対応、Laravel Sanctum認証統合、Page Object Modelパターン採用
- **E2E CI/CD自動実行**: GitHub Actions統合完了、Pull Request時の自動E2Eテスト実行（4 Shard並列実行、約2分完了）
- **CI/CDパフォーマンス最適化**: Composerキャッシング、並列実行（concurrency設定）、タイムアウト最適化（60分→20分）
- **GitHub Actions発火最適化**: Concurrency設定による重複実行削減、Paths設定による担当領域明確化、API契約監視による整合性検証、実行頻度60-70%削減
- **固定ポート設定**: 開発環境ポート統一（User App: 13001、Admin App: 13002、API: 13000）による複数プロジェクト並行開発対応
- **Dockerヘルスチェック**: 全サービスのヘルスチェック機能統合、依存関係の自動管理、障害検知の早期化（IPv4明示対応）
- **詳細最適化ドキュメント**: 他プロジェクトへの移行ガイド完備、DDDアーキテクチャガイド・開発ガイド・テスト戦略ドキュメント統合
- **開発者エクスペリエンス**: Turbopack、Tailwind CSS v4、ESLintの統合開発環境
- **モノレポ統一コード品質管理**: ESLint 9 + Prettier設定、husky + lint-staged導入による自動品質チェック
- **PHP品質管理システム**: Laravel Pint + Larastan (PHPStan Level 8) + Pest 4 + Git Hooks + CI/CD統合による包括的コード品質保証

## ターゲットユースケース
- **B2Cアプリケーション開発**: EC、SaaS、メディアサイトなどの顧客向けサービス
- **管理ダッシュボード付きサービス**: コンテンツ管理、ユーザー管理、データ分析が必要なプラットフォーム
- **API駆動型アプリケーション**: モバイルアプリや外部システム連携を想定したサービス
- **プロトタイプ開発**: MVPや概念実証での迅速な開発開始
- **チーム開発**: フロントエンドとバックエンドの分離による並行開発

## 主要な価値提案
- **画期的なパフォーマンス**: 業界標準を上回る33.3%の起動速度向上とメモリ効率最適化
- **超高速環境構築**: Docker Compose統合により5分以内で全サービス起動、即座にコーディング開始可能
- **実証済みの最適化**: 定量的パフォーマンス測定と包括的ドキュメント化による信頼性
- **保守性の確保**: 明確な分離アーキテクチャと最小依存関係による長期的な拡張性
- **本番環境対応の信頼性**: Dockerヘルスチェック統合によるサービス起動保証、依存関係の自動管理、障害検知の早期化
- **現代的な開発手法**: TypeScript、包括的テスト環境、リンター等のベストプラクティス導入済み
- **チーム開発の効率化**: API専用設計と固定ポート設定による役割分担と並行開発の最適化
- **本番環境対応**: Dockerベースの構成とステートレス設計による環境差異の最小化
- **移行容易性**: 詳細ドキュメントによる他プロジェクトへの最適化手法適用可能
- **品質管理の自動化**: Git Hooks + CI/CDによる自動品質チェック、人的エラー削減
- **完全なテスト戦略**: ユニット（Jest/Pest）→統合（Testing Library）→E2E（Playwright + Docker）の3層テスト体制、テストDB環境管理（SQLite/PostgreSQL切り替え、並列実行）
- **高速CI/CDパイプライン**: Composerキャッシング、並列実行最適化、タイムアウト短縮による開発効率向上
- **インテリジェントCI/CD**: Paths設定による必要最小限のワークフロー実行、Concurrencyによる重複実行自動キャンセル、API契約変更の早期検出

## アーキテクチャ上の特徴
- **API専用最適化**: Web機能削除によるステートレス設計とパフォーマンス最大化
- **🏗️ DDD/クリーンアーキテクチャ**:
  - **4層構造**: Domain層（ビジネスロジック）、Application層（ユースケース）、Infrastructure層（外部システム）、HTTP層（インターフェース）
  - **依存性逆転原則**: Domain層を中心とした依存方向の制御、フレームワーク非依存設計
  - **Repository Pattern**: データアクセスの抽象化、テスタビリティの向上
  - **SOLID原則準拠**: 単一責任、オープン・クローズド、リスコフの置換、インターフェース分離、依存性逆転
  - **Architecture Testing**: Pestによる依存方向とレイヤー分離の自動検証
- **最小依存関係**: Laravel 12 + Sanctum + Tinker + Pintの4コアパッケージ構成
- **フロントエンド分離**: 管理者とユーザーの異なるUIニーズに対応
- **🔐 Laravel Sanctumトークンベース認証**:
  - **ステートレス設計**: セッション不使用、水平スケーリング対応
  - **Personal Access Tokens**: UUIDベーストークン、有効期限管理
  - **認証エンドポイント**: `/api/login`, `/api/logout`, `/api/me`, `/api/tokens/*`
  - **トークンライフサイクル管理**: 自動期限切れ削除（Scheduled Tasks統合）、手動取り消し機能
  - **セキュリティベストプラクティス**: `auth:sanctum` middleware、CSRF保護、レート制限対応
  - **PHPStan Level 8準拠**: 型安全性保証、静的解析合格
- **CORS最適化**: Next.js フロントエンドとの完全統合設定
- **モジュラー構成**: 各コンポーネントの独立開発・デプロイ可能、既存MVCとDDD層の共存戦略
- **包括的最適化ドキュメント**: `backend/laravel-api/docs/`に移行ガイド・DDDアーキテクチャガイド完備
- **開発環境統一**: Docker Compose統合による全サービス一括起動・一貫した環境構築
- **Dockerヘルスチェック統合**: 全サービス（Laravel API、Next.js apps、PostgreSQL、Redis）のヘルスチェック機能、`docker compose ps`によるリアルタイム状態確認、IPv4明示対応（localhost→127.0.0.1）
- **PostgreSQL接続最適化**: ServiceProvider方式によるタイムアウト設定、環境別設定テンプレート（Docker/Native/Production）、エラーハンドリング強化
- **固定ポート設計**: 13000番台統一によるポート競合回避、複数プロジェクト同時実行対応
- **Next.js最適化構成**: outputFileTracingRoot設定によるDocker Standalone最適化

## 最適化実績
### パフォーマンス改善メトリクス
| 項目 | 改善前 | 改善後 | 改善率 |
|------|--------|--------|---------|
| **起動速度** | ベースライン | 33.3ms | **33.3%向上** |
| **メモリ効率** | 30.8MB | 0.33KB/request | **画期的改善** |
| **依存関係** | 114パッケージ | 4コア | **96.5%削減** |
| **レスポンス** | - | 11.8ms | **<20ms達成** |

### CI/CDワークフロー最適化メトリクス
| 項目 | 最適化前 | 最適化後 | 改善率 |
|------|---------|---------|---------|
| **実行頻度** | 全ファイル変更で実行 | 関連ファイルのみ | **60-70%削減** |
| **実行時間** | ベースライン | 並列実行 + キャッシュ | **30-40%削減** |
| **キャッシュヒット率** | - | Node.js/Composer | **80%以上** |
| **API契約整合性** | 検出なし | 自動検出 | **早期検出** |