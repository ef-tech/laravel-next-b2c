<?php

declare(strict_types=1);

/**
 * ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®š
 *
 * ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã”ã¨ã®å‹•çš„ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®šã‚’ç®¡ç†ã—ã¾ã™ã€‚
 * ãƒ­ã‚°ã‚¤ãƒ³ã€èªè¨¼æ¸ˆã¿APIã€å…¬é–‹APIãªã©ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®åˆ¶é™å€¤ã‚’å®šç¾©ã—ã¾ã™ã€‚
 *
 * Requirements: 3.2, 3.7, 3.8, 3.9, 3.11, 13.2
 */
return [
    /*
    |--------------------------------------------------------------------------
    | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ¥ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®š
    |--------------------------------------------------------------------------
    |
    | å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®šã§ã™ã€‚
    | ç’°å¢ƒå¤‰æ•°ã§è¨­å®šã‚’ä¸Šæ›¸ãå¯èƒ½ï¼ˆ.env.exampleã‚’å‚ç…§ï¼‰
    |
    | - requests: è¨±å¯ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ï¼ˆç’°å¢ƒå¤‰æ•°: RATELIMIT_{ENDPOINT}_REQUESTSï¼‰
    | - per_minute: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æ™‚é–“å˜ä½ï¼ˆåˆ†ï¼‰ï¼ˆç’°å¢ƒå¤‰æ•°: RATELIMIT_{ENDPOINT}_PER_MINUTEï¼‰
    | - by: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è­˜åˆ¥å­ï¼ˆip/user/tokenï¼‰ï¼ˆç’°å¢ƒå¤‰æ•°: RATELIMIT_{ENDPOINT}_BYï¼‰
    |
    | âš ï¸ è¨­å®šå¤‰æ›´æ™‚ã®å½±éŸ¿:
    | - requests ã‚’å¢—ã‚„ã™: ã‚µãƒ¼ãƒãƒ¼è² è·å¢—åŠ ã€DDoSè€æ€§ä½ä¸‹
    | - requests ã‚’æ¸›ã‚‰ã™: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“æ‚ªåŒ–ã€æ­£å¸¸åˆ©ç”¨è€…ã¸ã®å½±éŸ¿
    | - by ã‚’å¤‰æ›´: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ãŒå¤‰ã‚ã‚‹ãŸã‚æ—¢å­˜åˆ¶é™ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹
    |
    */
    'endpoints' => [
        /*
        |----------------------------------------------------------------------
        | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆèªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
        |----------------------------------------------------------------------
        |
        | èªè¨¼ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®APIåˆ©ç”¨åˆ¶é™
        |
        | æ¨å¥¨è¨­å®šå€¤: 60-120 req/min
        | è­˜åˆ¥æ–¹æ³•: ipï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã¾ãŸã¯ userï¼ˆèªè¨¼æ¸ˆã¿ï¼‰
        |
        | ğŸ’¡ è¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ:
        | - é€šå¸¸ã®APIåˆ©ç”¨ã§ã¯60 req/minã§ååˆ†ï¼ˆ1ç§’ã«1ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰
        | - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒ£ãƒƒãƒˆç­‰ï¼‰ã¯120 req/minæ¨å¥¨
        | - 'by' ã‚’ 'user' ã«ã™ã‚‹ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼IDå˜ä½ã§åˆ¶é™å¯èƒ½
        |
        */
        'api' => [
            'requests' => (int) env('RATELIMIT_API_REQUESTS', 60),
            'per_minute' => (int) env('RATELIMIT_API_PER_MINUTE', 1),
            'by' => env('RATELIMIT_API_BY', 'ip'),
        ],

        /*
        |----------------------------------------------------------------------
        | Publicã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆæœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
        |----------------------------------------------------------------------
        |
        | èªè¨¼ä¸è¦ã®å…¬é–‹APIåˆ¶é™
        |
        | æ¨å¥¨è¨­å®šå€¤: 30-60 req/min
        | è­˜åˆ¥æ–¹æ³•: ipï¼ˆIPã‚¢ãƒ‰ãƒ¬ã‚¹å˜ä½ï¼‰
        |
        | ğŸ’¡ è¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ:
        | - èªè¨¼æ¸ˆã¿ã‚ˆã‚Šå³ã—ãè¨­å®šï¼ˆDDoSå¯¾ç­–ï¼‰
        | - ãƒ­ã‚°ã‚¤ãƒ³å‰ã®ãƒšãƒ¼ã‚¸è¡¨ç¤ºãƒ»ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ç­‰ã§ä½¿ç”¨
        | - 'by' ã¯å¿…ãš 'ip' ã‚’ä½¿ç”¨ï¼ˆæœªèªè¨¼ã®ãŸã‚ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥ä¸å¯ï¼‰
        |
        */
        'public' => [
            'requests' => (int) env('RATELIMIT_PUBLIC_REQUESTS', 30),
            'per_minute' => (int) env('RATELIMIT_PUBLIC_PER_MINUTE', 1),
            'by' => env('RATELIMIT_PUBLIC_BY', 'ip'),
        ],

        /*
        |----------------------------------------------------------------------
        | Webhookã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æºï¼‰
        |----------------------------------------------------------------------
        |
        | å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ã®Webhookå—ä¿¡åˆ¶é™
        |
        | æ¨å¥¨è¨­å®šå€¤: 100-200 req/min
        | è­˜åˆ¥æ–¹æ³•: ipï¼ˆé€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹å˜ä½ï¼‰
        |
        | ğŸ’¡ è¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ:
        | - Stripe, GitHubç­‰ã®Webhookå—ä¿¡ã§ä½¿ç”¨
        | - å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒªãƒˆãƒ©ã‚¤æŒ™å‹•ã‚’è€ƒæ…®ã—ã¦é«˜ã‚ã«è¨­å®š
        | - ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ãŒé«˜é »åº¦ã®å ´åˆã¯å€‹åˆ¥ã«èª¿æ•´
        |
        */
        'webhook' => [
            'requests' => (int) env('RATELIMIT_WEBHOOK_REQUESTS', 100),
            'per_minute' => (int) env('RATELIMIT_WEBHOOK_PER_MINUTE', 1),
            'by' => env('RATELIMIT_WEBHOOK_BY', 'ip'),
        ],

        /*
        |----------------------------------------------------------------------
        | Strictã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆç®¡ç†è€…APIãƒ»æ©Ÿå¯†æ“ä½œï¼‰
        |----------------------------------------------------------------------
        |
        | ã‚µãƒ¼ãƒãƒ¼é–“é€šä¿¡ã‚„ç®¡ç†è€…ç”¨APIåˆ¶é™
        |
        | æ¨å¥¨è¨­å®šå€¤: 10-20 req/min
        | è­˜åˆ¥æ–¹æ³•: userï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼IDå˜ä½ï¼‰
        |
        | ğŸ’¡ è¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ:
        | - æ©Ÿå¯†æ€§ã®é«˜ã„æ“ä½œï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ã€æ¨©é™å¤‰æ›´ç­‰ï¼‰ã§ä½¿ç”¨
        | - å³ã—ã„åˆ¶é™ã«ã‚ˆã‚Šä¸æ­£æ“ä½œãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–
        | - 'by' ã‚’ 'user' ã«ã—ã¦èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼å˜ä½ã§åˆ¶é™
        |
        */
        'strict' => [
            'requests' => (int) env('RATELIMIT_STRICT_REQUESTS', 10),
            'per_minute' => (int) env('RATELIMIT_STRICT_PER_MINUTE', 1),
            'by' => env('RATELIMIT_STRICT_BY', 'user'),
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¹ãƒˆã‚¢è¨­å®š
    |--------------------------------------------------------------------------
    |
    | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®ä¿å­˜å…ˆè¨­å®šã§ã™ã€‚
    | Redisã‚’ä½¿ç”¨ã—ã¦é«˜é€Ÿãªåˆ†æ•£ã‚«ã‚¦ãƒ³ãƒˆã‚’å®Ÿç¾ã—ã¾ã™ã€‚
    |
    | ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã¯ RATELIMIT_CACHE_STORE=array ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€
    | ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆé–“ã®å¹²æ¸‰ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚
    |
    */
    'cache' => [
        'store' => env('RATELIMIT_CACHE_STORE', 'redis'),
        'prefix' => 'rate_limit',
    ],
];
